import numpy as np
import matplotlib.pyplot as plt

#define myself
#from config import *

def loss_plot():
    
    #sub_axix = filter(lambda x:x%50 == 0, x_axix)
    #plt.figure(figsize=(6,6))
    
    x_axix = range(50)
    img_loss = [0.1652, 0.1619, 0.1564, 0.1541, 0.1576, 0.1533, 0.1616, 0.1578, 0.1538, 0.1520,
                0.1532, 0.1540, 0.1539, 0.1541, 0.1522, 0.1514, 0.1525, 0.1537, 0.1511, 0.1550,
                0.1544, 0.1510, 0.1529, 0.1524, 0.1530, 0.1515, 0.1517, 0.1506, 0.1510, 0.1501,
                0.1512, 0.1503, 0.1514, 0.1505, 0.1513, 0.1533, 0.1528, 0.1509, 0.1510, 0.1527,
                0.1536, 0.1508, 0.1526, 0.1519, 0.1519, 0.1495, 0.1510, 0.1507, 0.1510, 0.1512]

    roi_loss = [0.1379, 0.1332, 0.1302, 0.1304, 0.1312, 0.1266, 0.1293, 0.1300, 0.1271, 0.1248,
                0.1239, 0.1272, 0.1269, 0.1243, 0.1211, 0.1244, 0.1224, 0.1261, 0.1214, 0.1232,
                0.1259, 0.1223, 0.1220, 0.1271, 0.1237, 0.1242, 0.1219, 0.1213, 0.1236, 0.1219,
                0.1214, 0.1239, 0.1207, 0.1199, 0.1216, 0.1206, 0.1220, 0.1203, 0.1202, 0.1209,
                0.1223, 0.1214, 0.1256, 0.1211, 0.1252, 0.1215, 0.1203, 0.1228, 0.1220, 0.1212]

    fusion_loss = [0.1369, 0.1312, 0.1267, 0.1257, 0.1272, 0.1219, 0.1280, 0.1271, 0.1225, 0.1217,
                   0.1191, 0.1230, 0.1217, 0.1197, 0.1188, 0.1205, 0.1181, 0.1226, 0.1174, 0.1200,
                   0.1238, 0.1194, 0.1182, 0.1227, 0.1208, 0.1196, 0.1179, 0.1176, 0.1194, 0.1181,
                   0.1184, 0.1197, 0.1166, 0.1157, 0.1182, 0.1172, 0.1187, 0.1167, 0.1168, 0.1177,
                   0.1196, 0.1173, 0.1219, 0.1167, 0.1218, 0.1172, 0.1171, 0.1182, 0.1174, 0.1177]

    val_loss = [0.1569, 0.1531, 0.1482, 0.1465, 0.1492, 0.1448, 0.1518, 0.1492, 0.1453, 0.1435,
                0.1439, 0.1455, 0.1453, 0.1447, 0.1426, 0.1429, 0.1430, 0.1451, 0.1418, 0.1451,
                0.1456, 0.1421, 0.1433, 0.1444, 0.1440, 0.1429, 0.1423, 0.1415, 0.1424, 0.1413,
                0.1419, 0.1420, 0.1417, 0.1409, 0.1420, 0.1432, 0.1433, 0.1414, 0.1414, 0.1428,
                0.1440, 0.1416, 0.1441, 0.1422, 0.1435, 0.1406, 0.1415, 0.1419, 0.1419, 0.1418]
    # 1
    #plt.subplot(1, 1, 1)
    cls_loss_pt = plt.plot(x_axix,img_loss,label='BCE loss of the image classifier', color='y')
    seg_loss_pt = plt.plot(x_axix,roi_loss,label='BCE loss of the region classifier', color='g')
    sum_loss_pt = plt.plot(x_axix,fusion_loss,label='BCE loss of the fusion classifier', color='b', linestyle='-')
    couple_loss_pt = plt.plot(x_axix,val_loss,label='BCE loss of the CXR-IRNet', color='r', linestyle='-')
    plt.xlabel('Epochs')
    plt.ylabel('BCE Loss')
    plt.title('Validation loss of the common split on the chest X-ray8 dataset')
    plt.legend()
    plt.savefig('/data/pycode/CXR-IRNet/imgs/Val_loss.jpg')


if __name__ == "__main__":
    loss_plot()